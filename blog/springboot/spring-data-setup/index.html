<!doctype html><html lang=en-us><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><title>Accessing databases using Spring Data JPA - Spring Boot Guides</title><meta name=HandheldFriendly content="True"><meta name=MobileOptimized content="320"><meta name=referrer content="no-referrer"><meta name=description content><meta property="og:site_name" content="Spring Boot Guides"><meta property="og:locale" content="en_US"><meta property="og:type" content="article"><meta property="og:url" content="https://blog.florian-moehle.de/blog/springboot/spring-data-setup/"><meta property="og:title" content="Accessing databases using Spring Data JPA"><meta property="og:image" content="https://blog.florian-moehle.de/"><meta property="og:description" content><meta name=twitter:card content="summary_large_image"><meta name=twitter:title content="Accessing databases using Spring Data JPA"><meta name=twitter:description content><style>@import 'https://fonts.googleapis.com/css2?family=Noto+Serif+Display:wght@500&family=Source+Serif+Pro:wght@300&display=swap'</style><meta name=twitter:image content="https://blog.florian-moehle.de/"><link rel=canonical href=https://blog.florian-moehle.de/blog/springboot/spring-data-setup/><link rel=stylesheet href=https://blog.florian-moehle.de/css/site.css><link rel=stylesheet href=https://blog.florian-moehle.de/css/custom.css><link href=https://blog.florian-moehle.de/index.xml rel=alternate type=application/rss+xml title="Spring Boot Guides"></head><body><head><script async src="https://www.googletagmanager.com/gtag/js?id=G-E52YHHLZG3"></script>
<script>var doNotTrack=!1;if(!doNotTrack){window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments)}gtag("js",new Date),gtag("config","G-E52YHHLZG3",{anonymize_ip:!1})}</script><script type=application/javascript>var doNotTrack=!1;doNotTrack||(window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)},ga.l=+new Date,ga("create","G-E52YHHLZG3","auto"),ga("send","pageview"))</script><script async src=https://www.google-analytics.com/analytics.js></script></head><div class="mt-xl header"><header><div class=container><div class="row justify-content-center"><div class=col-auto><a href=https://blog.florian-moehle.de/ style=display:contents><h1 class="name text-center">Spring Boot Guides</h1></a></div></div><div class="row justify-content-center"><section class="nav justify-content-center"><ul><li class="nav-item justify-content-center mx-auto"><a class=nav-link href=/>Home</a></li><li class="nav-item justify-content-center mx-auto"><a class=nav-link href=https://florian-moehle.de>Personal Website</a></li></ul></section></div></div></header></div><div class=content><div class=container><div class="row justify-content-center"><div class="col-sm-12 col-lg-8"><h1 class="mx-0 mx-md-4 blog-post-title">Accessing databases using Spring Data JPA</h1><div class="meta-data meta"><span class="author meta-data" title="Florian M.">Florian M.</span>
<span class="date middot meta-data" title='Sat Nov 26 2022 17:36:52 +0100'>2022-11-26</span>
<span class="reading-time middot meta-data">3 min read</span>
<a class="middot meta-data" href=https://blog.florian-moehle.de/blog/springboot/spring-data-setup/>Permalink</a><div class="d-none d-md-inline tags"><ul class="list-unstyled d-inline"><li class=d-inline style=margin-right:.5rem><a href=https://blog.florian-moehle.de/tags/data>#Data</a></li></ul></div></div><div class="markdown blog-post-content"><h2 id=introduction>Introduction</h2><p>Whenever we need to handle persistent data in our application a Database connection of some kind
is required.
Spring Data helps us to deal with those situations by providing an easy-to-use suite of libraries into its own
Framework&rsquo;s architecture.</p><p>We are going to focus on the JPA flavor of Spring Data in this article as it&rsquo;s easiest to understand when coming from
non-Spring based Projects (Using Hibernate directly for example).</p><p>You can also add automatic <a href=https://blog.florian-moehle.de/blog/springboot/spring-liquibase/>Database schema migrations using Liquibase</a> after integrating Spring Data into your application.</p><h2 id=integrating-spring-data-jpa>Integrating Spring Data JPA</h2><p>Spring Data JPA can be added as a dependency in your <code>build.gradle</code> file. You can add the H2 Database dependency for
local testing as well:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-groovy data-lang=groovy><span style=display:flex><span>dependencies <span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>    implementation <span style=color:#e6db74>&#39;org.springframework.boot:spring-boot-starter-data-jpa&#39;</span>
</span></span><span style=display:flex><span>    
</span></span><span style=display:flex><span>    <span style=color:#75715e>// Optional: A JDBC Driver for the specific Database you are trying to connect to
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    <span style=color:#75715e>// implementation &#39;com.mysql:mysql-connector-j&#39;
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    <span style=color:#75715e>// implementation &#39;org.mariadb.jdbc:mariadb-java-client&#39;
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    <span style=color:#75715e>// implementation &#39;com.microsoft.sqlserver:mssql-jdbc&#39;
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>
</span></span><span style=display:flex><span>    <span style=color:#75715e>// Optional, for local testing
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    implementation <span style=color:#e6db74>&#39;com.h2database:h2&#39;</span>
</span></span><span style=display:flex><span><span style=color:#f92672>}</span>
</span></span></code></pre></div><h2 id=connecting-to-your-database>Connecting to your Database</h2><p>Spring creates a Datasource object for creating connections to the Database.
The connection parameters can be configured in the <code>application.properties</code> file.
We are using a local H2 Database instance in this example:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-properties data-lang=properties><span style=display:flex><span><span style=color:#a6e22e>spring.datasource.url</span><span style=color:#f92672>=</span><span style=color:#e6db74>jdbc:h2:file:./database</span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>spring.datasource.username</span><span style=color:#f92672>=</span><span style=color:#e6db74>sa</span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>spring.datasource.password</span><span style=color:#f92672>=</span>
</span></span></code></pre></div><h2 id=using-spring-data-jpa>Using Spring Data JPA</h2><h3 id=creating-entity-objects>Creating Entity objects</h3><p>JPA annotations are used to create a mapping between Java Objects and Database entries.
We are going to create a simple Customer object which matches our Database schema.
Create a new entity class called <code>Customer</code> in your project:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=display:flex><span><span style=color:#a6e22e>@Entity</span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>@Table</span><span style=color:#f92672>(</span>name <span style=color:#f92672>=</span> <span style=color:#e6db74>&#34;RegisteredCustomers&#34;</span><span style=color:#f92672>)</span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>public</span> <span style=color:#66d9ef>class</span> <span style=color:#a6e22e>Customer</span> <span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>	<span style=color:#a6e22e>@Id</span>
</span></span><span style=display:flex><span>	<span style=color:#a6e22e>@GeneratedValue</span><span style=color:#f92672>(</span>strategy <span style=color:#f92672>=</span> GenerationType<span style=color:#f92672>.</span><span style=color:#a6e22e>IDENTITY</span><span style=color:#f92672>)</span>
</span></span><span style=display:flex><span>	<span style=color:#66d9ef>private</span> Long id<span style=color:#f92672>;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>	<span style=color:#a6e22e>@Column</span><span style=color:#f92672>(</span>name <span style=color:#f92672>=</span> <span style=color:#e6db74>&#34;firstName&#34;</span><span style=color:#f92672>)</span>
</span></span><span style=display:flex><span>	<span style=color:#66d9ef>private</span> String firstName<span style=color:#f92672>;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>	<span style=color:#a6e22e>@Column</span><span style=color:#f92672>(</span>name <span style=color:#f92672>=</span> <span style=color:#e6db74>&#34;lastName&#34;</span><span style=color:#f92672>)</span>
</span></span><span style=display:flex><span>	<span style=color:#66d9ef>private</span> String lastName<span style=color:#f92672>;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>	<span style=color:#66d9ef>public</span> <span style=color:#a6e22e>Customer</span><span style=color:#f92672>()</span> <span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>		<span style=color:#75715e>// Default constructor for Hibernate
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>	<span style=color:#f92672>}</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>	<span style=color:#66d9ef>public</span> <span style=color:#a6e22e>Customer</span><span style=color:#f92672>(</span>String firstName<span style=color:#f92672>,</span> String lastName<span style=color:#f92672>)</span> <span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>		<span style=color:#66d9ef>this</span><span style=color:#f92672>.</span><span style=color:#a6e22e>firstName</span> <span style=color:#f92672>=</span> firstName<span style=color:#f92672>;</span>
</span></span><span style=display:flex><span>		<span style=color:#66d9ef>this</span><span style=color:#f92672>.</span><span style=color:#a6e22e>lastName</span> <span style=color:#f92672>=</span> lastName<span style=color:#f92672>;</span>
</span></span><span style=display:flex><span>	<span style=color:#f92672>}</span>
</span></span><span style=display:flex><span>	
</span></span><span style=display:flex><span>	<span style=color:#75715e>// Getters omitted
</span></span></span><span style=display:flex><span><span style=color:#75715e></span><span style=color:#f92672>}</span>
</span></span></code></pre></div><p>We are using the @Entity annotation on our class to tell Spring (to be exact: Hibernate which comes with Spring Data) that
this class maps to some entry in our database.
Using the @Table annotation we are specifying to which table&rsquo;s entries it should be mapped.</p><h3 id=setting-up-the-repository>Setting up the Repository</h3><p>To interact with the entities and our database we first need to create a Repository interface.
These implement some CRUD operations by default and can be extended at will.
We need to create a <code>CustomerRepository</code> interface with a simple custom query for this example:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=display:flex><span><span style=color:#a6e22e>@Repository</span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>public</span> <span style=color:#66d9ef>interface</span> <span style=color:#a6e22e>CustomerRepository</span> <span style=color:#66d9ef>extends</span> JpaRepository<span style=color:#f92672>&lt;</span>Customer<span style=color:#f92672>,</span> Long<span style=color:#f92672>&gt;</span> <span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    List<span style=color:#f92672>&lt;</span>Customer<span style=color:#f92672>&gt;</span> <span style=color:#a6e22e>findByLastName</span><span style=color:#f92672>(</span>String lastName<span style=color:#f92672>);</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#f92672>}</span>
</span></span></code></pre></div><p>As you can see we are only extending the default JpaRepository and specifying the two type parameters <code>&lt;Customer, Long></code>:
<code>Customer</code> as our entity which is handled by this interface and <code>Long</code> as the primary key type being used for this entity.</p><p>We also added a single Method called <code>findByLastName</code> with a parameter <code>lastName</code> to our interface.
The naming of this method is important as Spring is able to derive the <code>SQL SELECT</code> Query just from the method name itself -
no implementation or special <code>@Query</code> annotation needed.</p><h3 id=building-our-service-layer>Building our Service Layer</h3><p>Service classes are the only Database-related classes which should be visible to the rest of our business logic.</p></div></div><div class=container><div class="footer-row justify-content-center meta" id=footer><a>Florian M.</a><div class=footer-spacer></div><a href=policy.html>Privacy Policy</a></div><script defer src=https://blog.florian-moehle.de/js/custom.js></script></div></div></div></div></body></html>