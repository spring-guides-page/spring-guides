<!doctype html><html lang=en-us><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><title>Migrating Databases with Liquibase - Spring Boot Guides</title><meta name=HandheldFriendly content="True"><meta name=MobileOptimized content="320"><meta name=referrer content="no-referrer"><meta name=description content><meta property="og:site_name" content="Spring Boot Guides"><meta property="og:locale" content="en_US"><meta property="og:type" content="article"><meta property="og:url" content="https://blog.florian-moehle.de/blog/springboot/spring-liquibase/"><meta property="og:title" content="Migrating Databases with Liquibase"><meta property="og:image" content="https://blog.florian-moehle.de/"><meta property="og:description" content><meta name=twitter:card content="summary_large_image"><meta name=twitter:title content="Migrating Databases with Liquibase"><meta name=twitter:description content><style>@import 'https://fonts.googleapis.com/css2?family=Noto+Serif+Display:wght@500&family=Source+Serif+Pro:wght@300&display=swap'</style><meta name=twitter:image content="https://blog.florian-moehle.de/"><link rel=canonical href=https://blog.florian-moehle.de/blog/springboot/spring-liquibase/><link rel=stylesheet href=https://blog.florian-moehle.de/css/site.css><link rel=stylesheet href=https://blog.florian-moehle.de/css/custom.css><link href=https://blog.florian-moehle.de/index.xml rel=alternate type=application/rss+xml title="Spring Boot Guides"></head><body><head><script async src="https://www.googletagmanager.com/gtag/js?id=G-E52YHHLZG3"></script>
<script>var doNotTrack=!1;if(!doNotTrack){window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments)}gtag("js",new Date),gtag("config","G-E52YHHLZG3",{anonymize_ip:!1})}</script><script type=application/javascript>var doNotTrack=!1;doNotTrack||(window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)},ga.l=+new Date,ga("create","G-E52YHHLZG3","auto"),ga("send","pageview"))</script><script async src=https://www.google-analytics.com/analytics.js></script></head><div class="mt-xl header"><header><div class=container><div class="row justify-content-center"><div class=col-auto><a href=https://blog.florian-moehle.de/ style=display:contents><h1 class="name text-center">Spring Boot Guides</h1></a></div></div><div class="row justify-content-center"><section class="nav justify-content-center"><ul></ul></section></div></div></header></div><div class=content><div class=container><div class="row justify-content-center"><div class="col-sm-12 col-lg-8"><h1 class="mx-0 mx-md-4 blog-post-title">Migrating Databases with Liquibase</h1><div class="meta-data meta"><div class="d-none d-md-inline meta-brief">Integrating automated Database Migrations into Spring using Liquibase</div><span class="author meta-data" title="Florian M.">Florian M.</span>
<span class="date middot meta-data" title='Sat Nov 26 2022 11:23:52 +0100'>2022-11-26</span>
<span class="reading-time middot meta-data">2 min read</span>
<a class="middot meta-data" href=https://blog.florian-moehle.de/blog/springboot/spring-liquibase/>Permalink</a><div class="d-none d-md-inline tags"><ul class="list-unstyled d-inline"></ul></div></div><div class="markdown blog-post-content"><p>Updating an application sometimes requires changing the underlying database schema.
We will cover how to implement automated database migrations using Liquibase in Spring Boot.</p><h2 id=liquibase---a-short-introduction>Liquibase - a short Introduction</h2><p>Liquibase is used in many different Java applications to perform automated database migrations on application startup.
This is done by integrating so-called Changelog files in the application&rsquo;s executable.
These Changelogs can contain multiple Changesets which contain the logic for transforming the database schema.</p><p>Liquibase transforms these changesets into SQL queries at runtime, independent of the database type being used.</p><h2 id=prerequisites>Prerequisites</h2><p>As Liquibase uses the application&rsquo;s database connection a Spring managed Datasource is required to run changesets.</p><h2 id=integrating-liquibase>Integrating Liquibase</h2><h3 id=adding-the-dependency>Adding the Dependency</h3><p>Add Liquibase as a dependency in your project&rsquo;s <code>build.gradle</code> file:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-groovy data-lang=groovy><span style=display:flex><span>dependencies <span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>    implementation <span style=color:#e6db74>&#39;org.liquibase:liquibase-core&#39;</span>
</span></span><span style=display:flex><span><span style=color:#f92672>}</span>
</span></span></code></pre></div><p>There is no need to specify a version of the dependency as Liquibase is a Spring-managed dependency and is kept
up-to-date automatically when updating the Spring Boot version of your project.</p><h3 id=configuring-the-application>Configuring the application</h3><p>Liquibase searches for the file <code>db/changelog/db.changelog-master.yaml</code> on the application&rsquo;s classpath for Changelogs by default.
As we are going to use XML as our Changelog format we have to add the following line to the <code>application.properties</code> file in our project:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-properties data-lang=properties><span style=display:flex><span><span style=color:#a6e22e>spring.liquibase.change-log</span><span style=color:#f92672>=</span><span style=color:#e6db74>classpath:/db/changelog/db.changelog-master.xml</span>
</span></span></code></pre></div><h2 id=writing-your-first-changelog>Writing your first Changelog</h2><p>Create a new file called <code>db.changelog-master.xml</code> under <code>src/main/resources/db/changelog/</code> in your application.
The following Changelog contains one changeset which creates a new Table called <code>RegisteredCustomers</code>:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-xml data-lang=xml><span style=display:flex><span><span style=color:#f92672>&lt;databaseChangeLog</span>
</span></span><span style=display:flex><span>        <span style=color:#a6e22e>xmlns=</span><span style=color:#e6db74>&#34;http://www.liquibase.org/xml/ns/dbchangelog&#34;</span>
</span></span><span style=display:flex><span>        <span style=color:#a6e22e>xmlns:xsi=</span><span style=color:#e6db74>&#34;http://www.w3.org/2001/XMLSchema-instance&#34;</span>
</span></span><span style=display:flex><span>        <span style=color:#a6e22e>xsi:schemaLocation=</span><span style=color:#e6db74>&#34;http://www.liquibase.org/xml/ns/dbchangelog
</span></span></span><span style=display:flex><span><span style=color:#e6db74>		http://www.liquibase.org/xml/ns/dbchangelog/dbchangelog-latest.xsd&#34;</span><span style=color:#f92672>&gt;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>&lt;changeSet</span> <span style=color:#a6e22e>author=</span><span style=color:#e6db74>&#34;DB-Author-1&#34;</span> <span style=color:#a6e22e>id=</span><span style=color:#e6db74>&#34;AddRegisteredCustomersTable&#34;</span><span style=color:#f92672>&gt;</span>
</span></span><span style=display:flex><span>        <span style=color:#f92672>&lt;createTable</span> <span style=color:#a6e22e>tableName=</span><span style=color:#e6db74>&#34;RegisteredCustomers&#34;</span><span style=color:#f92672>&gt;</span>
</span></span><span style=display:flex><span>            <span style=color:#f92672>&lt;column</span> <span style=color:#a6e22e>name=</span><span style=color:#e6db74>&#34;id&#34;</span> <span style=color:#a6e22e>type=</span><span style=color:#e6db74>&#34;BIGINT&#34;</span> <span style=color:#a6e22e>autoIncrement=</span><span style=color:#e6db74>&#34;true&#34;</span><span style=color:#f92672>&gt;</span>
</span></span><span style=display:flex><span>                <span style=color:#f92672>&lt;constraints</span> <span style=color:#a6e22e>primaryKey=</span><span style=color:#e6db74>&#34;true&#34;</span><span style=color:#f92672>/&gt;</span>
</span></span><span style=display:flex><span>            <span style=color:#f92672>&lt;/column&gt;</span>
</span></span><span style=display:flex><span>            <span style=color:#f92672>&lt;column</span> <span style=color:#a6e22e>name=</span><span style=color:#e6db74>&#34;firstName&#34;</span> <span style=color:#a6e22e>type=</span><span style=color:#e6db74>&#34;VARCHAR(64)&#34;</span> <span style=color:#f92672>/&gt;</span>
</span></span><span style=display:flex><span>            <span style=color:#f92672>&lt;column</span> <span style=color:#a6e22e>name=</span><span style=color:#e6db74>&#34;lastName&#34;</span> <span style=color:#a6e22e>type=</span><span style=color:#e6db74>&#34;VARCHAR(64)&#34;</span> <span style=color:#f92672>/&gt;</span>
</span></span><span style=display:flex><span>        <span style=color:#f92672>&lt;/createTable&gt;</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>&lt;/changeSet&gt;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#f92672>&lt;/databaseChangeLog&gt;</span>
</span></span></code></pre></div></div></div><div class=container><span class="row justify-content-center meta" id=footer>Copyright Â©
2022
Florian M.</span>
<script defer src=https://blog.florian-moehle.de/js/custom.js></script></div></div></div></div></body></html>